<%- include('../layouts/userLayouts/header') %>
<div class="bg-white sticky-top">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white">
    <div class="container">
      <!-- Logo with Dummy Image -->
      <a class="navbar-brand d-flex align-items-center" href="">
        <span style="font-size: 32px; font-weight: bold; color: black"
          >AXIOS</span
        ><sup style="color: black">Â®</sup>
      </a>
      <!-- Search Form -->
      <form
        class="d-flex mx-auto w-50"
        id="searchForm"
        action="/showcase"
        method="GET"
      >
        <input
          class="form-control search-bar"
          style="
            border: none;
            box-shadow: 0px 0px 6px rgba(0, 0, 0, 0.3);

            padding: 20px 15px;
            border-radius: 5px;
            height: 48px;
          "
          type="search"
          name="searchProduct"
          placeholder="Search for items..."
          aria-label="Search"
          value="<%= searchProduct || '' %>"
        />
      </form>

      <!-- Icons -->
      <ul
        style="margin-right: 10px"
        class="navbar-nav mb-2 mb-lg-0 d-flex align-items-center"
      >
        <li class="nav-item me-3">
          <a
            class="nav-link"
            href="/wishlist"
            style="color: black; font-weight: bold; font-size: 24px"
          >
            <i class="fi-rs-heart"></i>
          </a>
        </li>
        <li class="nav-item me-3">
          <a
            class="nav-link"
            href="/cart"
            style="color: black; font-weight: bold; font-size: 24px"
          >
            <i class="fi-rs-shopping-cart"></i>
          </a>
        </li>
        <li class="nav-item me-3">
          <a
            class="nav-link"
            href="/profile"
            style="color: black; font-weight: bold; font-size: 24px"
          >
            <i class="fi-rs-user"></i>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container" style="height: 70px">
    <div class="row">
      <div class="col-12 text-center mt-3">
        <ul style="user-select: none" class="list-inline">
          <li class="list-inline-item">
            <a
              href="/showcase?targetGroup=men"
              style="
                color: black;
                font-weight: bold;
                font-size: 20px;
                padding-right: 10px;
              "
              >Mens</a
            >
          </li>
          <li class="list-inline-item">
            <a
              href="/showcase?targetGroup=women"
              style="
                color: black;
                font-weight: bold;
                font-size: 20px;
                padding-right: 10px;
              "
              >Womens</a
            >
          </li>
          <li class="list-inline-item">
            <a
              href="/showcase?targetGroup=kids"
              style="
                color: black;
                font-weight: bold;
                font-size: 20px;
                padding-right: 10px;
              "
              >Kids</a
            >
          </li>
          <li class="list-inline-item">
            <a
              href="/"
              style="
                color: black;
                font-weight: bold;
                font-size: 20px;
                padding-right: 10px;
              "
              >About Us</a
            >
          </li>
          <li class="list-inline-item">
            <a
              href="/"
              style="
                color: black;
                font-weight: bold;
                font-size: 20px;
                padding-right: 10px;
              "
              >Contact</a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<main class="main">
  <div class="container my-5">
    <div
      class="jumbotron text-center"
      style="
        background-color: #e9ecef;
        border-radius: 1rem;
        padding: 3rem;
        margin-bottom: 2rem;
      "
    >
      <p class="lead" style="font-size: 1.25rem; font-weight: 300">
        Discover amazing deals and exclusive offers!
      </p>
    </div>
    <section class="mb-5">
      <div class="row">
        <% activeProductOffers.forEach(product=> { %> <% if
        (product.productOffer) { %>
        <h2
          class="section-title"
          style="
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
          "
        >
          Exclusive Product Offers
        </h2>
        <div class="col-md-3 mb-4">
          <div
            class="card h-100 shadow-sm"
            style="
              border: none;
              cursor: pointer;
              border-radius: 0.5rem;
              overflow: hidden;
              height: 100%;
            "
          >
            <a href="/products/<%= product._id %>" class="text-decoration-none">
              <img
                class="card-img-top"
                src="/productImages/<%= product?.images[0]?.filename %>"
                alt="<%= product.productOffer.offerName %>"
                style="
                  height: 200px;
                  object-fit: cover;
                  border-bottom: 1px solid #dee2e6;
                "
            /></a>
            <div class="card-body d-flex flex-column" style="padding: 1.5rem">
              <h5 class="card-title" style="color: #333">
                <%= product.productOffer.offerName %>
              </h5>
              <p class="card-text" style="color: #555">
                <span class="text-danger fw-bold" style="color: #dc3545">
                  <%= product.productOffer.offerDiscountPercentage %>% OFF
                </span>
              </p>
              <a
                href="/products/<%= product._id %>"
                class="text-decoration-none btn btn-primary mt-auto"
                >Shop Now</a
              >
            </div>
          </div>
        </div>
        <% } %> <% }) %>
      </div>
    </section>

    <div class="container my-5">
      <section class="mb-5">
        <div class="row">
          <% activeCategoryOffers.forEach(category=> { %> <% if
          (category.categoryOffer) { %>
          <h2
            class="section-title"
            style="
              font-size: 2rem;
              font-weight: 700;
              margin-bottom: 2rem;
              text-align: center;
            "
          >
            Category Offers
          </h2>
          <div class="col-md-4 mb-4">
            <div
              class="card h-100 shadow-sm"
              style="
                border: none;
                cursor: pointer;
                border-radius: 0.5rem;
                overflow: hidden;
                height: 100%;
              "
            >
              <div
                class="card-body d-flex flex-column text-center p-4"
                style="
                  background-color: #f8f9fa;
                  border-radius: 10px;
                  padding: 1.5rem;
                "
              >
                <div class="icon mb-3">
                  <i class="fas fa-tag fa-3x" style="color: #333"></i>
                </div>

                <h5
                  class="card-title"
                  style="color: #333; font-size: 1.8rem; font-weight: 700"
                >
                  <%= category.categoryOffer.offerName %>
                </h5>

                <p
                  class="card-text mt-3"
                  style="color: #555; font-size: 1.4rem; color: #555"
                >
                  <span class="fw-bold">
                    <%= category.categoryOffer.offerDiscountPercentage %>% OFF
                  </span>
                </p>

                <a
                  class="btn btn-dark mt-auto fw-bold"
                  style="border-radius: 25px; padding: 10px 20px"
                >
                  Explore Now
                </a>
              </div>
            </div>
          </div>
          <% } %> <% }) %>
        </div>
      </section>
    </div>

    <section
      class="product-tabs section-padding position-relative wow fadeIn animated"
    >
      <div class="bg-square"></div>
      <div class="container">
        <div class="container my-5">
          <section
            class="popular-brands-section my-5"
            style="
              background-color: #000;
              color: #fff;
              padding: 2rem;
              border-radius: 10px;
            "
          >
            <h2
              class="h4 font-weight-bold text-center mb-4"
              style="
                color: #f0f0f0;

                text-transform: uppercase;
              "
            >
              Popular Brands
            </h2>
            <div
              class="brands-container d-flex justify-content-center flex-wrap"
              style="max-width: 1200px; margin: 0 auto"
            >
              <% popularBrand.forEach(brand=> { %>
              <div
                class="brand-card p-3 m-2 text-center"
                style="
                  background-color: #1c1c1c;
                  border: 2px solid #333;
                  border-radius: 8px;
                  transition: transform 0.3s, box-shadow 0.3s;
                  min-width: 150px;
                  max-width: 200px;
                  width: 100%;
                  color: #f0f0f0;
                "
              >
                <span
                  class="brand-name"
                  style="
                    font-size: 1.2rem;
                    font-weight: 600;
                    text-transform: uppercase;
                    display: block;
                    color: #f0f0f0;
                  "
                >
                  <%= brand.brandName %>
                </span>
              </div>
              <% }) %>
            </div>
          </section>

          <section
            class="new-arrivals-section my-5"
            style="
              background-color: #f8f9fa;
              padding: 2rem;
              border-radius: 10px;
            "
          >
            <h2
              class="h4 font-weight-bold text-center mb-4"
              style="
                background-color: #f8f9fa;
                color: #333;
                font-size: 24px;
                font-weight: 700;
                text-transform: uppercase;
              "
            >
              New Arrivals
            </h2>
            <div class="row product-grid-5">
              <% newArrivals.forEach(product=> { %>
              <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div
                  class="card shadow-sm mb-3"
                  id="productContainer<%= product._id %>"
                  style="
                    width: 100%;
                    max-width: 18rem;
                    margin: auto;
                    cursor: pointer;
                    border-radius: 0.5rem;
                    overflow: hidden;
                    height: 100%;
                  "
                >
                  <a
                    href="/products/<%= product._id %>"
                    class="text-decoration-none"
                  >
                    <img
                      src="/productImages/<%= product.images[0]?.filename %>"
                      class="card-img-top"
                      style="
                        width: 100%;
                        height: 200px;
                        object-fit: cover;
                        height: 200px;
                        object-fit: cover;
                        border-bottom: 1px solid #dee2e6;
                      "
                      alt="Product Image"
                    />
                  </a>
                  <div class="card-body" style="padding: 1.5rem">
                    <div
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <a
                        href="/products/id=<%= product._id %>"
                        class="text-decoration-none"
                        style="
                          flex: 1;
                          white-space: nowrap;
                          overflow: hidden;
                          text-overflow: ellipsis;
                        "
                      >
                        <h5
                          class="card-title"
                          style="
                            font-size: 14px;
                            margin-bottom: 0;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                            max-width: 100%;
                            color: #333;
                          "
                        >
                          <%= product.name %>
                        </h5>
                      </a>
                    </div>
                    <p class="card-text" style="color: #555">
                      <% if (product?.productSalesPriceAfterOfferDiscount && new
                      Date(product?.productOffer?.offerExpiryDate)> new Date()
                      && product?.productSalesPriceAfterOfferDiscount !== 0 &&
                      product?.productOffer?.offerStatus) { %>
                      <strong
                        >â¹<%=
                        Math.floor(product.productSalesPriceAfterOfferDiscount).toLocaleString('en-IN')
                        %></strong
                      >
                      <% } else { %>
                      <strong
                        >â¹<%=
                        Math.floor(product.salesPrice).toLocaleString('en-IN')
                        %></strong
                      >
                      <% } %>
                    </p>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </section>

          <!-- Best Sellers Section -->
          <section class="my-5">
            <h2
              class="h4 font-weight-bold mb-4 text-center"
              style="font-size: 24px; color: #333"
            >
              Best Sellers
            </h2>
            <div class="row">
              <% bestSellers.forEach(item=> { %>
              <div class="col-6 col-md-3 mb-4">
                <div
                  class="card h-100 shadow-sm border-0"
                  style="
                    border: none;
                    cursor: pointer;
                    border-radius: 0.5rem;
                    overflow: hidden;
                    height: 100%;
                  "
                >
                  <a
                    href="/products/<%= item._id %>"
                    class="text-decoration-none"
                  >
                    <img
                      src="/productImages/<%= item?.firstImage?.filename %>"
                      class="card-img-top"
                      style="
                        height: 200px;
                        object-fit: cover;
                        border-radius: 0;
                        height: 200px;
                        object-fit: cover;
                        border-bottom: 1px solid #dee2e6;
                      "
                      alt="<%= item.productName %>"
                    />
                  </a>
                  <div class="card-body" style="padding: 1.5rem">
                    <h5
                      class="card-title text-dark"
                      style="
                        font-size: 16px;
                        font-weight: 600;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        white-space: nowrap;
                        color: #333;
                      "
                    >
                      <%= item.productName %>
                    </h5>
                    <p
                      class="card-text text-muted"
                      style="color: black !important; color: #555"
                    >
                      â¹<%= item.price.toFixed(2) %>
                    </p>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </section>

          <!-- Top Deals Section -->
          <hr class="my-4" />
          <section class="my-5">
            <h2
              class="h4 font-weight-bold mb-4 text-center"
              style="font-size: 24px; color: #333"
            >
              Top Deals
            </h2>
            <div class="row">
              <% topDeals.forEach(item=> { %>
              <div class="col-6 col-md-3 mb-4">
                <div
                  class="card h-100 shadow-sm border-0"
                  style="
                    border: none;
                    cursor: pointer;
                    border-radius: 0.5rem;
                    overflow: hidden;
                    height: 100%;
                  "
                >
                  <a
                    href="/products/<%= item._id %>"
                    class="text-decoration-none"
                  >
                    <img
                      src="/productImages/<%= item?.images[0]?.filename %>"
                      class="card-img-top"
                      style="
                        height: 200px;
                        object-fit: cover;
                        border-radius: 0;
                        height: 200px;
                        object-fit: cover;
                        border-bottom: 1px solid #dee2e6;
                      "
                      alt="<%= item.name %>"
                    />
                  </a>
                  <div class="card-body" style="padding: 1.5rem">
                    <h5
                      class="card-title text-dark"
                      style="
                        font-size: 16px;
                        font-weight: 600;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        white-space: nowrap;
                        color: #333;
                      "
                    >
                      <%= item.name %>
                    </h5>
                    <% if (item?.productOffer &&
                    item?.productOffer?.offerDiscountPercentage && new
                    Date(item?.productOffer?.offerExpiryDate)> new Date() &&
                    item?.productSalesPriceAfterOfferDiscount !== 0 &&
                    item?.productOffer?.offerStatus) { %>
                    <div
                      class="offer-tag"
                      style="
                        position: absolute;
                        top: 10px;
                        right: 10px;
                        background-color: red;
                        color: white;
                        padding: 5px 10px;
                        border-radius: 5px;
                        font-weight: bold;
                        z-index: 20;

                        pointer-events: none;
                      "
                    >
                      <span>
                        <%= item?.productOffer?.offerDiscountPercentage %> % OFF
                      </span>
                    </div>
                    <% } %>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </section>
          <hr class="my-4" />
        </div>
        <div class="tab-content wow fadeIn animated" id="myTabContent">
          <div
            class="tab-pane fade show active"
            id="tab-one"
            role="tabpanel"
            aria-labelledby="tab-one"
          >
            <div class="container mt-5">
              <div
                class="tab-pane fade show active"
                id="tab-one"
                role="tabpanel"
                aria-labelledby="tab-one"
              >
                <% if (productsArray.length===0) { %>
                <div class="text-center">
                  <h3>No Products Found Yet</h3>
                </div>
                <% } else { %>
                <div class="row product-grid-5">
                  <% for(let i=0; i < productsArray.length; i++) { %>
                  <div class="col-lg-2-4 col-md-3 col-6 col-sm-4">
                    <div
                      class="product-cart-wrap mb-30"
                      style="border: none; box-shadow: none"
                    >
                      <div
                        class="product-img-action-wrap"
                        style="position: relative"
                      >
                        <div
                          class="product-img product-img-zoom"
                          style="position: relative"
                        >
                          <a href="/products/<%= productsArray[i]._id %>">
                            <img
                              class="default-img"
                              src="/productImages/<%= productsArray[i]?.images[0]?.filename %>"
                              alt=""
                            />
                          </a>
                        </div>
                      </div>
                      <div class="product-content-wrap">
                        <div class="product-category">
                          <a class="h4"> <%= productsArray[i].brand.name %> </a>
                        </div>
                        <h5
                          style="
                            overflow: hidden;
                            text-overflow: ellipsis;
                            white-space: nowrap;
                          "
                        >
                          <a href="/products/<%= productsArray[i]._id %>">
                            <%= productsArray[i].name %>
                          </a>
                        </h5>
                        <div>
                          <% if (productsArray[i]?.productOffer &&
                          productsArray[i]?.productOffer?.offerDiscountPercentage&&new
                          Date(productsArray[i]?.productOffer?.offerExpiryDate)>
                          new
                          Date()&&productsArray[i]?.productSalesPriceAfterOfferDiscount!==0&&productsArray[i]?.productOffer?.offerStatus)
                          { %>
                          <div
                            class="offer-tag"
                            style="
                              position: absolute;
                              top: 10px;
                              right: 10px;
                              background-color: red;
                              color: white;
                              padding: 5px 10px;
                              border-radius: 5px;
                              font-weight: bold;
                              z-index: 20;

                              pointer-events: none;
                            "
                          >
                            <span>
                              <%=
                              productsArray[i]?.productOffer?.offerDiscountPercentage
                              %> % OFF
                            </span>
                          </div>
                          <% } else { %> <% } %>
                        </div>
                        <div class="product-price">
                          <%if(productsArray[i].isBlocked ||
                          productsArray[i].category?.isBlocked||productsArray?.isBlocked)
                          { %>

                          <span style="color: red">Currently Unavailable</span>
                          <%} else { %> <% if
                          (productsArray[i]?.productSalesPriceAfterOfferDiscount
                          && new
                          Date(productsArray[i]?.productOffer?.offerExpiryDate)>
                          new
                          Date()&&productsArray[i]?.productSalesPriceAfterOfferDiscount
                          !==0 && productsArray[i]?.productOffer?.offerStatus) {
                          %>

                          <span
                            >â¹ <%=
                            Math.floor(productsArray[i].productSalesPriceAfterOfferDiscount).toLocaleString('en-IN')
                            %></span
                          >

                          <% } else { %>

                          <span
                            >â¹ <%=
                            Math.floor(productsArray[i].salesPrice).toLocaleString('en-IN')
                            %></span
                          >

                          <% } %> <% } %>
                        </div>
                      </div>
                    </div>
                  </div>
                  <% } %>
                </div>
                <% } %>
              </div>

              <div
                class="pagination-area mt-30 mb-50 text-center"
                style="display: flex; justify-content: center; margin: 30px 0"
              >
                <nav aria-label="Page navigation example">
                  <ul
                    class="pagination justify-content-start"
                    style="display: flex; gap: 5px"
                  >
                    <% if (currentPage> 1) { %>
                    <li class="page-item" style="margin: 0 2px">
                      <a class="page-link" href="?page=<%= currentPage - 1 %>">
                        <strong>&lt;</strong>
                      </a>
                    </li>
                    <% } %> <% let startPage=Math.max(1, currentPage - 2); let
                    endPage=Math.min(totalPages, startPage + 4); if (endPage -
                    startPage < 4) { startPage=Math.max(1, endPage - 4); } %> <%
                    for (let i=startPage; i <=endPage; i++) { %>
                    <li
                      class="page-item <%= i === currentPage ? 'active' : '' %>"
                      style="margin: 0 2px"
                    >
                      <a class="page-link" href="?page=<%= i %>"
                        ><strong> <%= i %> </strong></a
                      >
                    </li>
                    <% } %> <% if (currentPage < totalPages) { %>
                    <li class="page-item" style="margin: 0 2px">
                      <a class="page-link" href="?page=<%= currentPage + 1 %>">
                        <strong>&gt;</strong>
                      </a>
                    </li>
                    <% } %>
                  </ul>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</main>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    let successMessage = "<%= successMessage %>";
    if (successMessage) {
      Swal.fire({
        text: successMessage,
        icon: "success",
        toast: true,
        position: "top-right",
        showConfirmButton: false,
        timerProgressBar: true,
        timer: 3000,
      });
    }
  });
</script>
<%- include('../layouts/userLayouts/footer') %>

